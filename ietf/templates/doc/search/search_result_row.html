{% load widget_tweaks %}
{% load ietf_filters %}

<tr>

  <td>
    {% if user.is_authenticated %}
      {% if doc.name in doc_is_tracked %}
        <a href="{% url "community_remove_track_document" doc.name %}" class="community-list-add-remove-doc" title="Remove from your personal ID list">
          <span class="fa fa-bookmark-o"></span>
        </a>
      {% else %}
        <a href="{% url "community_add_track_document" doc.name %}" class="community-list-add-remove-doc" title="Add to your personal ID list">
          <span class="fa fa-bookmark"></span>
        </a>
      {% endif %}
    {% endif %}
  </td>

  <td class="doc">
    <p>
      <a href="{{ doc.get_absolute_url }}">{% if doc.get_state_slug == "rfc" %}RFC {{ doc.rfc_number }}{% else %}{{ doc.name }}-{{ doc.rev }}{% endif %}</a>

      {% if doc.get_state_slug == "rfc" and "draft" in doc.name %}
        <i>(was {{ doc.name }})</i>
      {% endif %}
      <br>
      <b>{{ doc.title }}</b>
      {% if doc.has_errata %}
        <a class="label label-danger" href="//www.rfc-editor.org/errata_search.php?rfc={{ doc.rfc_number }}">Errata</a>
      {% endif %}

      {% if doc.pages %}
        <br><small class="text-muted">{{doc.pages}} page{{ doc.pages|pluralize }}</small>
      {% endif %}
    </p>

    {% if user|has_role:"Secretariat" and doc.reschedule_form %}
      <div class="form-group">
        <label for="{{ doc.reschedule_form.telechat_date.auto_id}}">Reschedule:</label>
        {{ doc.reschedule_form.telechat_date|add_class:"form-control input-sm" }}
      </div>
      {% if doc.reschedule_form.show_clear %}
        <div class="checkbox">
          <label>{{ doc.reschedule_form.clear_returning_item }} <b>Clear "returning item"</b></label>
        </div>
      {% endif %}
    {% endif %}
  </td>

  <td class="text-nowrap">
    {% if doc.latest_revision_date|timesince_days|new_enough:request and doc.get_state_slug != "rfc" %}<a href="{{ rfcdiff_prefix }}?url2={{ doc.name }}-{{ doc.rev }}">{% endif %}{% if doc.get_state_slug == "rfc" %}{{ doc.latest_revision_date|date:"Y-m" }}{% else %}{{ doc.latest_revision_date|date:"Y-m-d" }}{% endif %}{% if doc.latest_revision_date|timesince_days|new_enough:request %}{% if doc.get_state_slug != "rfc" %}</a>{% endif %}
      <wbr><span class="label label-success">New</span>
    {% endif %}

    {% if doc.get_state_slug == "active" and doc.expirable and doc.expires|timesince_days|expires_soon:request %}
      <wbr><span class="label label-warning">Expires soon</span>
    {% endif %}
  </td>

  {% include "doc/search/status_columns.html" %}

  <td class="ipr text-center">
    {% if doc.related_ipr %}
      <a href="{% url "ipr_search" %}?submit=draft&amp;id={{ doc.name }}">
        <span class="label label-default">{{ doc.related_ipr|length }}</span>
      </a>
    {% endif %}
  </td>

  {% if ad_name == None or ad_name != doc.ad.plain_name %}
    <td class="ad">
      {% if doc.ad %}
        <p>{{ doc.ad|default:"" }}</p>
      {% endif %}
      {% if doc.shepherd %}<small class="text-muted">{{doc.shepherd|default:""}}</small>{% endif %}
    </td>
  {% else %}
     <td></td>
  {% endif %}

</tr>
