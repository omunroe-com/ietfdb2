{% extends "group/group_base.html" %}

{% load ietf_filters %}

{% block group_subtitle %}Materials{% endblock %}

{% block group_content %}
  {% load ietf_filters %}

  {% if doc_types %}
    {% for doc_type, docs in doc_types %}
      <h2>{{ doc_type.name }}</h2>

      <table class="table table-condensed table-striped materials">
        <tr>
          <th>Title</th>
          <th>Abstract</th>
          <th>Curr. Rev.</th>
          <th>Date</th>
          <th>Last Presented</th>
          <th>On Agenda</th>
        </tr>

        {% for d in docs %}
          <tr>
            <td><a class="title-link" href="{% url "doc_view" name=d.name %}">{{ d.title }}</a></td>
            <td class='snippable'>{{ d.abstract|format_snippet }} </td>
            <td>{{ d.rev }}</td>
            <td>{{ d.time|date:"Y-m-d" }}</td>
            <td>{% regroup d.last_presented by session.meeting as past_pres_list %}
              {% for p in past_pres_list %}
                {{ p.grouper }}
                {% if p.list|length > 1 %}
                  ({{ p.list|length }} sessions)
                {% else %}
                  {% for pr in p.list %}
                    {% if pr.rev != d.rev %}
                      (-{{ pr.rev }})
                    {% endif %}
                  {% endfor %}
                {% endif %}
                {% if not forloop.last %}, {% endif %}
              {% endfor %}
              <td>{% regroup d.future_presentations by session.meeting as meeting_pres_list %} 
                {% for p in meeting_pres_list %}
                  {{ p.grouper }}
                  {% if p.list|length > 1 %}
                    ({{ p.list|length }} sessions)
                  {% else %}
                    {% for pr in p.list %}
                      {% if pr.rev != d.rev %}
                        (-{{ pr.rev }})
                      {% endif %}
                    {% endfor %}
                  {% endif %}
                  {% if not forloop.last %}, {% endif %}
                {% endfor %}
              </td>
          </tr>
        {% endfor %}
      </table>
    {% endfor %}
  {% else %}
    <h2>Materials</h2>

    <p>No materials uploaded.</p>
  {% endif %}

{% endblock %}
